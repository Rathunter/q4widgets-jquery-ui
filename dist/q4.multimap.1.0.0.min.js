/*
Widget:   q4.multimap
Version:  1.0.0
Compiled: 2015-03-02
*/
!function(a){a.widget("q4.multiMap",{options:{map:"us_lcc_en",backgroundColour:"transparent",defaultColour:"#ffffff",elementPrefix:"",views:[],viewContainer:".views",viewTrigger:"> li",viewTemplate:'<li class="{{cssClass}}"><span></span>{{label}}</li>',legendContainer:".legend",legendTemplate:'<li class="{{cssClass}}"><span style="background-color: {{colour}}"></span>{{label}}</li>',textContainer:".text",mapContainer:"#map",template:'<ul class="views"></ul><ul class="legend"></ul><div class="text"></div><div id="map"></div>'},_init:function(){var b=this.options,c=this.element;c.append(Mustache.render(b.template,{views:b.views})),a.each(b.views,function(d,e){a(b.viewContainer,c).append(Mustache.render(b.viewTemplate,e))}),a(b.mapContainer,c).vectorMap({map:b.map,backgroundColor:b.backgroundColour,zoomMax:1,series:{regions:[{attribute:"fill"}]}}),this.map=a(b.mapContainer,c).vectorMap("get","mapObject"),this._bindEvents(),a(b.viewContainer+" "+b.viewTrigger,c).first().click()},_bindEvents:function(){var b=this,c=this.options,d=this.element,e={};e["click "+c.viewContainer+" "+c.viewTrigger]=function(e){var f=a(c.viewContainer+" "+c.viewTrigger,d),g=a(e.currentTarget),h=a(c.legendContainer,d).empty(),i=a(c.textContainer,d);f.removeClass("active"),g.addClass("active");var j=c.views[f.index(g)];!j.legend&&"legend"in j||a.each(j.categories,function(a,b){h.append(Mustache.render(c.legendTemplate,b))}),i.html(j.text||"");var k={};a.each(b.map.series.regions[0].elements,function(a){k[a]=c.defaultColour}),a.each(j.categories,function(b,d){a.each(d.elements,function(a,b){k[c.elementPrefix+b]=d.colour})}),b.map.series.regions[0].setValues(k)},this._on(e)}})}(jQuery);